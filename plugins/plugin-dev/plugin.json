{
    "name": "Plugin Dev",
    "id": "plugin-dev",
    "description": "Developer tools for building plugins",
    "author": "Dev",
    "src": [
        {
            "type": "domloaded",
            "src": "const plugindev_pluginManagerOpenButton = document.createElement(\"button\");\nplugindev_pluginManagerOpenButton.classList.add(\"assetswapper-new-button\");\nplugindev_pluginManagerOpenButton.innerText = \"Developer\";\nsearchPluginsButton.parentElement.insertBefore(plugindev_pluginManagerOpenButton, searchPluginsButton.nextElementSibling);\nconst plugindev_pluginManagerDiv = document.createElement(\"div\");\ndocument.getElementById(\"app\").appendChild(plugindev_pluginManagerDiv);\nplugindev_pluginManagerDiv.outerHTML = `\n    <div id=\"plugindev_pluginManagerModalContainer\" class=\"drc-modal-modal-container drc-modal-hidden\">\n    <div id=\"plugindev_pluginManagerContainer\" class=\"drc-modal-container\">\n        <div id=\"plugindev_pluginManagerModal\" class=\"modal-content drc-modal-modal-content\">\n            <span class=\"drc-modal-title\">\n                <div></div>\n                <div class=\"justify-self-center\">Developer Plugins Manager</div>\n                <div></div>\n            </span>\n            <div class=\"drc-modal-content\">\n                <p>Welcome, Developer</p>\n                <button id=\"plugindev_newPluginButton\" class=\"assetswapper-new-button\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\"\n                        class=\"bi bi-plus\" viewBox=\"0 0 16 16\">\n                        <path\n                            d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\" />\n                    </svg>\n                    New\n                </button>\n                <div class=\"spacer\"></div>\n                <div class=\"assetswapper-list-rule\">\n                    <select id=\"plugindev_selectPlugin\"></select>\n                    <div class=\"spacer\"></div>\n                    <button id=\"plugindev_openPluginButton\" class=\"assetswapper-new-button\">\n                        Open Existing\n                    </button>\n                    <div class=\"spacer\"></div>\n                    <button id=\"plugindev_exportPluginButton\" class=\"assetswapper-new-button\">\n                        Export\n                    </button>\n                </div>\n                <div class=\"spacer\"></div>\n                <div class=\"assetswapper-list-rule\">\n                <input id=\"plugindev_selectImportFile\" type=\"file\" accept=\".json\">\n                    <div class=\"spacer\"></div>\n                    <button id=\"plugindev_importPluginButton\" class=\"assetswapper-new-button\">\n                        Import\n                    </button>\n                </div>\n            </div>\n            <button id=\"plugindev_pluginManagerCloseButton\" class=\"drc-modal-close\"><svg width=\"1.125em\"\n                    height=\"1.125em\" viewBox=\"0 0 24 24\" class=\"svg-icon\" color=\"gray\"\n                    style=\"--sx:1; --sy:1; --r:0deg;\">\n                    <path\n                        d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\">\n                    </path>\n                </svg></button>\n        </div>\n    </div>\n</div>\n`;\nconst plugindev_pluginManagerModalContainer = document.getElementById(\"plugindev_pluginManagerModalContainer\");\nconst plugindev_pluginManagerCloseButton = document.getElementById(\"plugindev_pluginManagerCloseButton\");\nconst plugindev_newPluginButton = document.getElementById(\"plugindev_newPluginButton\");\nconst plugindev_openPluginButton = document.getElementById(\"plugindev_openPluginButton\");\nconst plugindev_exportPluginButton = document.getElementById(\"plugindev_exportPluginButton\");\nconst plugindev_importPluginButton = document.getElementById(\"plugindev_importPluginButton\");\nconst plugindev_selectPlugin = document.getElementById(\"plugindev_selectPlugin\");\nconst plugindev_selectImportFile = document.getElementById(\"plugindev_selectImportFile\");\n// Dev button onclick\nfunction plugindev_reloadImportExport() {\n    // reload open/export\n    plugindev_selectPlugin.innerHTML = \"\";\n    for (let i in settings.pluginsData) {\n        const elem = document.createElement(\"option\");\n        elem.setAttribute(\"value\", settings.pluginsData[i].id);\n        elem.innerText = settings.pluginsData[i].name;\n        plugindev_selectPlugin.appendChild(elem);\n    }\n}\n\nplugindev_pluginManagerOpenButton.addEventListener(\"click\", () => {\n    plugindev_pluginManagerModalContainer.classList.toggle(\"drc-modal-hidden\");\n    plugindev_reloadImportExport();\n});\nplugindev_pluginManagerCloseButton.addEventListener(\"click\", () => {\n    plugindev_pluginManagerModalContainer.classList.toggle(\"drc-modal-hidden\");\n});\nconst plugindev_pluginEditorDiv = document.createElement(\"div\");\ndocument.getElementById(\"app\").appendChild(plugindev_pluginEditorDiv);\nplugindev_pluginEditorDiv.outerHTML = `\n    <div id=\"plugindev_pluginEditorModalContainer\" class=\"drc-modal-modal-container drc-modal-hidden\">\n    <div id=\"plugindev_pluginEditorContainer\" class=\"drc-modal-container\">\n        <div id=\"plugindev_pluginEditorModal\" class=\"modal-content drc-modal-modal-content\">\n            <span class=\"drc-modal-title\">\n                <div></div>\n                <div class=\"justify-self-center\">Plugin Editor</div>\n                <div></div>\n            </span>\n            <div class=\"drc-modal-content\">\n                <div>\n                    <div class=\"spacer\"></div>\n                    <div class=\"assetswapper-list-rule\">\n                        <p>Name: </p>\n                        <div class=\"spacer\"></div>\n                        <input type=\"text\" id=\"plugindev_OptionsName\" placeholder=\"Plugin Name\">\n                    </div>\n                    <div class=\"spacer\"></div>\n                    <div class=\"assetswapper-list-rule\">\n                        <p>ID: </p>\n                        <div class=\"spacer\"></div>\n                        <input type=\"text\" id=\"plugindev_OptionsId\" placeholder=\"Plugin ID\">\n                    </div>\n                    <div class=\"spacer\"></div>\n                    <div class=\"assetswapper-list-rule\">\n                        <p>Description: </p>\n                        <div class=\"spacer\"></div>\n                        <input type=\"text\" id=\"plugindev_OptionsDescription\" placeholder=\"Plugin Description\">\n                    </div>\n                    <div class=\"spacer\"></div>\n                    <div class=\"assetswapper-list-rule\">\n                        <p>Author: </p>\n                        <div class=\"spacer\"></div>\n                        <input type=\"text\" id=\"plugindev_OptionsAuthor\" placeholder=\"Plugin Author\">\n                    </div>\n                </div>\n                <div class=\"spacer\"></div>\n                <button id=\"plugindev_newScript\" class=\"assetswapper-new-button\">\n                    New Script\n                </button>\n                <div class=\"spacer\"></div>\n                <div id=\"plugindev_OptionsSrc\">\n\n                </div>\n                <button id=\"plugindev_pluginEditorSaveButton\" class=\"assetswapper-new-button\">Save</button>\n            </div>\n            <button id=\"plugindev_pluginEditorCloseButton\" class=\"drc-modal-close\"><svg width=\"1.125em\"\n                    height=\"1.125em\" viewBox=\"0 0 24 24\" class=\"svg-icon\" color=\"gray\"\n                    style=\"--sx:1; --sy:1; --r:0deg;\">\n                    <path\n                        d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\">\n                    </path>\n                </svg></button>\n        </div>\n    </div>\n</div>\n`;\nconst plugindev_pluginEditorModalContainer = document.getElementById(\"plugindev_pluginEditorModalContainer\");\nconst plugindev_pluginEditorCloseButton = document.getElementById(\"plugindev_pluginEditorCloseButton\");\nconst plugindev_pluginEditorSaveButton = document.getElementById(\"plugindev_pluginEditorSaveButton\");\nconst plugindev_OptionsName = document.getElementById(\"plugindev_OptionsName\");\nconst plugindev_OptionsId = document.getElementById(\"plugindev_OptionsId\");\nconst plugindev_OptionsDescription = document.getElementById(\"plugindev_OptionsDescription\");\nconst plugindev_OptionsAuthor = document.getElementById(\"plugindev_OptionsAuthor\");\nconst plugindev_OptionsSrc = document.getElementById(\"plugindev_OptionsSrc\");\nconst plugindev_newScriptButton = document.getElementById(\"plugindev_newScript\");\nplugindev_newScriptButton.addEventListener(\"click\", () => {\n    // new script\n    const mainElem = document.createElement(\"div\");\n    plugindev_OptionsSrc.appendChild(mainElem);\n    mainElem.setAttribute(\"style\", \"display:flex\");\n    const typeElem = document.createElement(\"select\");\n    mainElem.appendChild(typeElem);\n    typeElem.innerHTML = `\n        <option value=\"startup\">startup</option>\n        <option value=\"appstart\">appstart</option>\n        <option value=\"preload\">preload</option>\n        <option value=\"domloaded\">domloaded</option>\n        <option value=\"game\">game</option>\n        <option value=\"install\">install</option>\n        <option value=\"uninstall\">uninstall</option>\n        <option value=\"update\">update</option>\n        `;\n    const spacer1 = document.createElement(\"div\");\n    spacer1.classList.add(\"spacer\");\n    mainElem.appendChild(spacer1);\n    const srcElem = document.createElement(\"textarea\");\n    mainElem.appendChild(srcElem);\n    const spacer2 = document.createElement(\"div\");\n    spacer2.classList.add(\"spacer\");\n    mainElem.appendChild(spacer2);\n    const deleteElem = document.createElement(\"button\");\n    deleteElem.classList.add(\"assetswapper-new-button\");\n    deleteElem.innerText = \"Delete Script\";\n    mainElem.appendChild(deleteElem);\n    deleteElem.addEventListener(\"click\", () => {\n        mainElem.remove();\n        spacer.remove();\n    });\n    const spacer = document.createElement(\"div\");\n    spacer.classList.add(\"spacer\");\n    plugindev_OptionsSrc.appendChild(spacer);\n});\nfunction plugindev_formatSrc() {\n    let src = [];\n    for (let i in plugindev_OptionsSrc.children) {\n        if (typeof (plugindev_OptionsSrc.children[i]) != \"object\")\n            continue;\n        if (plugindev_OptionsSrc.children[i].classList.contains(\"spacer\"))\n            continue;\n        src.push({\n            type: plugindev_OptionsSrc.children[i].querySelector(\"select\").value,\n            src: plugindev_OptionsSrc.children[i].querySelector(\"textarea\").value\n        });\n    }\n    return src;\n}\n;\n// Plugin editor button onclick\nplugindev_newPluginButton.addEventListener(\"click\", () => {\n    plugindev_OptionsName.value = \"\";\n    plugindev_OptionsId.value = \"\";\n    plugindev_OptionsDescription.value = \"\";\n    plugindev_OptionsAuthor.value = \"\";\n    plugindev_OptionsSrc.innerHTML = \"\";\n    plugindev_pluginEditorModalContainer.classList.toggle(\"drc-modal-hidden\");\n});\nplugindev_pluginEditorCloseButton.addEventListener(\"click\", () => {\n    plugindev_pluginEditorModalContainer.classList.toggle(\"drc-modal-hidden\");\n});\nplugindev_pluginEditorSaveButton.addEventListener(\"click\", () => {\n    settings.pluginsData = settings.pluginsData.filter(plugin => {\n        return plugin.id != plugindev_OptionsId.value;\n    });\n    settings.pluginsData.push({\n        name: plugindev_OptionsName.value,\n        id: plugindev_OptionsId.value,\n        description: plugindev_OptionsDescription.value,\n        author: plugindev_OptionsAuthor.value,\n        src: plugindev_formatSrc()\n    });\n    // clear\n    plugindev_OptionsName.value = \"\";\n    plugindev_OptionsId.value = \"\";\n    plugindev_OptionsDescription.value = \"\";\n    plugindev_OptionsAuthor.value = \"\";\n    plugindev_OptionsSrc.innerHTML = \"\";\n    plugindev_pluginEditorModalContainer.classList.toggle(\"drc-modal-hidden\");\n    saveSettings();\n    updateInstalledPluginsList();\n    plugindev_reloadImportExport();\n});\n// open existing\nplugindev_openPluginButton.addEventListener(\"click\", () => {\n    for (let i in settings.pluginsData) {\n        if (settings.pluginsData[i].id != plugindev_selectPlugin.value)\n            continue;\n        plugindev_OptionsName.value = settings.pluginsData[i].name;\n        plugindev_OptionsId.value = settings.pluginsData[i].id;\n        plugindev_OptionsDescription.value = settings.pluginsData[i].description;\n        plugindev_OptionsAuthor.value = settings.pluginsData[i].author;\n        plugindev_OptionsSrc.innerHTML = \"\";\n        for (let j in settings.pluginsData[i].src) {\n            // new script\n            const mainElem = document.createElement(\"div\");\n            plugindev_OptionsSrc.appendChild(mainElem);\n            mainElem.setAttribute(\"style\", \"display:flex\");\n            const typeElem = document.createElement(\"select\");\n            mainElem.appendChild(typeElem);\n            typeElem.innerHTML = `\n                <option value=\"startup\">startup</option>\n                <option value=\"appstart\">appstart</option>\n                <option value=\"preload\">preload</option>\n                <option value=\"domloaded\">domloaded</option>\n                <option value=\"game\">game</option>\n                <option value=\"install\">install</option>\n                <option value=\"uninstall\">uninstall</option>\n                <option value=\"update\">update</option>\n                `;\n            typeElem.value = settings.pluginsData[i].src[j].type;\n            const spacer1 = document.createElement(\"div\");\n            spacer1.classList.add(\"spacer\");\n            mainElem.appendChild(spacer1);\n            const srcElem = document.createElement(\"textarea\");\n            mainElem.appendChild(srcElem);\n            srcElem.value = settings.pluginsData[i].src[j].src;\n            const spacer2 = document.createElement(\"div\");\n            spacer2.classList.add(\"spacer\");\n            mainElem.appendChild(spacer2);\n            const deleteElem = document.createElement(\"button\");\n            deleteElem.classList.add(\"assetswapper-new-button\");\n            deleteElem.innerText = \"Delete Script\";\n            mainElem.appendChild(deleteElem);\n            deleteElem.addEventListener(\"click\", () => {\n                mainElem.remove();\n                spacer.remove();\n            });\n            const spacer = document.createElement(\"div\");\n            spacer.classList.add(\"spacer\");\n            plugindev_OptionsSrc.appendChild(spacer);\n        }\n        break;\n    }\n    plugindev_pluginEditorModalContainer.classList.toggle(\"drc-modal-hidden\");\n});\n// export\nplugindev_exportPluginButton.addEventListener(\"click\", () => {\n    let exportedPlugin = {};\n    for (let i in settings.pluginsData) {\n        if (settings.pluginsData[i].id != plugindev_selectPlugin.value)\n            continue;\n        exportedPlugin = structuredClone(settings.pluginsData[i]);\n        break;\n    };\n    delete exportedPlugin.version;\n    const content = JSON.stringify(exportedPlugin);\n    ipcRenderer.invoke(\"getPath\", \"downloads\")\n        .then(path => {\n            try {\n                fs.writeFileSync(path + `/${exportedPlugin.name.replace(/[^a-zA-Z0-9]/g, '')}.drcplugin.json`, content);\n                new Notification(\"Plugin exported!\", {\n                    body: `Your plugin has been exported to ${exportedPlugin.name.replace(/[^a-zA-Z0-9]/g, '')}.drcplugin.json in your Downloads folder. `\n                });\n                // file written successfully\n            }\n            catch (err) {\n                console.error(err);\n                new Notification(\"Something went wrong\", {\n                    body: `An error occurred while exporting your plugin.`\n                });\n            }\n        });\n});\n// import\nplugindev_importPluginButton.addEventListener(\"click\", () => {\n    // @ts-ignore I KNOW BETTER\n    if (plugindev_selectImportFile.files.length == 0)\n        return;\n    // @ts-ignore I KNOW BETTER\n    const theme = plugindev_selectImportFile.files[0];\n    const reader = new FileReader();\n    reader.addEventListener('load', (event) => {\n        let parsedPlugin = {};\n        try {\n            // @ts-ignore I KNOW BETTER\n            parsedPlugin = JSON.parse(atob(event.target.result.split(new RegExp(\",\"))[1]));\n        }\n        catch (e) {\n            new Notification(\"Something went wrong\", {\n                body: \"Something went wrong while importing your plugin. Check that it is not corrupted.\"\n            });\n        }\n        settings.pluginsData.push(parsedPlugin);\n        updateInstalledPluginsList();\n        saveSettings();\n        plugindev_reloadImportExport();\n    });\n    reader.readAsDataURL(theme);\n});\n\n// Advanced Theme\nthemeMakerAdvancedThemeContainer.classList.remove(\"drc-modal-hidden\");"
        }
    ]
}